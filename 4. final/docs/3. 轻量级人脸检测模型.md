# 轻量级人脸检测模型

## 综述

本次实验中，对于人脸检测任务，主要挑选了 RetinaFace、YOLO5Face、BlazeFace 这三个模型作为实验对象。

其中 RetinaFace 和 YOLO5Face 都在 WIDER Face 数据集上有较高的排名，RetinaFace 在提出的当年也达到了 state-of-the-art 的效果。

## RetinaFace

RetinaFace 是 Insight Face 在 2019 年提出的单阶段人脸检测模型，通过结合监督学习和自监督学习的多任务框架，可以同时实现人脸检测、关键点定位和密集人脸对应关系预测，通过选择不同的 backbone 可以得到不同精度和速度的模型。

本次实验中使用 RetinaFace 的轻量版本，主干网络为 mobilenet-0.25 以及 mobilenet v2，模型可以接收不经过缩放的原图进行推理。

## YOLO5Face

不同于其他人脸检测模型，YOLO5Face 把人脸检测看成是通用的目标检测任务。通过在 YOLOv5 的基础上添加了关键点回归、改进网络结构，实现了在 WiderFace 上的 state-of-the-art 效果，甚至超过了很多专用的人脸检测模型。

此外，YOLO5Face 基于 ShuffleNetv2 设计了两个轻量级模型，并在网络架构上做出了修改，模型非常小，可以在嵌入式设备和移动设备达到 SOTA。

本次实验中使用 YOLO5Face 的两个轻量版本，YOLOv5n 和 YOLOv5n-0.5，模型接受 640x640 的输入。实验使用 padding 的方式，将输入图片等比例缩放至 640x640 的尺寸。

## BlazeFace

BlazeFace 是 Google 提出的专为移动 GPU 优化的轻量级人脸检测模型，其主要特点是能在保持高精度的同时实现超实时性能。BlazeFace 也是目前 Google ML Kit和 MediaPipe 的默认人脸检测模型。

该模型的创新点主要体现在三个方面

首先，在 MobileNetV1/V2 的基础上定制了一个特征提取网络；其次，提出了一种新的适合 GPU 运算的 anchor 方案，通过在 8x8 特征图上使用 6 个 anchors 来替代传统 SSD 中多个分辨率层的 anchor 设计；第三，改进了传统的非极大值抑制 (NMS) 策略，提出了一种更平滑的重叠框处理方法，使得视频中的检测结果更加稳定。在实际应用中，BlazeFace 不仅能检测人脸边界框，还能预测 6 个面部关键点坐标并估计人脸旋转角度，这使其特别适合作为移动端 AR 应用 pipeline 的第一步处理。在 iPhone XS 等旗舰设备上，其推理时间仅需 0.6ms，比基于 MobileNetV2 的 SSD 模型快近 4 倍，充分展现了其在移动端的优越性能。

BlazeFace 论文中设计的模型输入图片尺寸是 128x128，专为移动端前置摄像头设计，BlazeFace 认为，一般前置摄像头下的人脸尺寸会占整个图像的 1/4 左右，在这种约束下，可以在做到高准确率的同时，保持较高的推理速度。

本次实验中，使用 BlazeFace 的 128x128 版本，模型接受 128x128 的输入。此外根据 BlazeFace 模型的架构，训练了两个分别接收 320x320 和 640x640 的模型。

实验使用 padding 的方式，将输入图片等比例缩放至所需的尺寸。
