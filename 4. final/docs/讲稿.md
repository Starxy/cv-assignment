# 讲稿

## 一、人脸检测任务介绍

人脸检测技术在当今社会有着广泛的应用价值，它是人脸智能分析应用的核心基础组件，为人脸识别、人脸属性分析（如年龄估计、性别识别、颜值打分和表情识别）、表情识别、智能视频监控、人脸图像过滤、智能图像裁切、人脸 AR 等众多应用提供了基础支持。例如，在智能安防领域，人脸检测可以快速识别监控画面中的人脸，为后续的分析和处理提供关键信息；在社交娱乐应用中，人脸检测可以实现有趣的特效和互动功能。

需要特别说明的是，人脸检测和人脸识别是两个不同的任务。
人脸检测主要是在图像或视频中检测出人脸所在的位置和边界框，其目标是确定图像中是否存在人脸，并标识出其大致位置，它通常作为更高级别任务（如人脸识别、表情识别等）的预处理步骤。
而人脸识别则是指识别和验证人脸的身份，目标是将输入的人脸图像与预先存储的人脸模板进行比较，并判断是否匹配。比如在机场安检、手机解锁等场景中，就是通过人脸识别来确认人员身份。

### 1. 技术挑战

由于拍摄场景的多样性，自然场景环境复杂多变，光照因素不可控，人脸本身存在多姿态以及群体间的相互遮挡等情况，这些都给检测任务带来了很大的难度。例如，在强光照射下或人脸部分被遮挡时，准确检测出人脸位置就变得更加困难。

1. 拍摄场景复杂多变
2. 光照因素不可控
3. 人脸多姿态变化
4. 群体间相互遮挡
5. 图像模糊等问题

### 2. 技术发展历程

到目前为止，人脸检测技术的发展经历了两个阶段：基于手工特征的传统方法和基于深度学习的方法。

#### 1.1 基于手工特征的传统方法

基于手工特征的传统方法主要依赖于手工设计的特征，早期方法可分为基于知识的方法、特征不变方法、模板匹配方法和基于外观的方法。例如，基于知识的方法利用人类对典型面孔结构的先验知识，通过提取面部特征并根据编码规则识别候选人脸；特征不变方法寻找对姿态和光照变化具有鲁棒性的人脸结构特征；模板匹配方法使用预先存储的人脸模板来确定人脸位置，但在处理尺寸、姿势和形状变化等问题上存在不足；基于外观的方法从训练人脸图像中学习人脸模型。2001 年，Viola 和 Jones 提出的开创性人脸检测算法，利用 Haar 特征和 Adaboost 算法训练强分类器，在实时应用中具有较高速度和准确性，但在面对遮挡、光照不均匀、角度变化较大或表情复杂等情况时容易出现误检或漏检问题。

#### 1.2 基于深度学习的方法

随着深度学习技术的发展，基于深度学习的人脸检测方法逐渐成为研究主流。这类方法能够自动学习图像中的复杂特征，在检测准确率上取得了显著优势。其架构主要分为多阶段检测架构、两阶段检测架构和单阶段检测架构。多阶段检测架构（如 Cascade CNN、MTCNN）运行速度较快、检测性能适中，适用于算力有限、背景简单且人脸数量较少的场景；两阶段检测架构（如 Face R - CNN、ScaleFace、FDNet）一般基于 Faster - RCNN 框架，检测准确率较高，但检测速度较慢；单阶段检测架构（如 SSD、RetinaNet）基于 Anchor 的分类和回归，检测速度较两阶段法快，检测性能较级联法优，是当前人脸检测算法优化的主流方向。不过，单阶段人脸检测器也面临着处理尺度变化、平衡正负样本比例、设计有效特征增强模块和优化方法等挑战。

### 3. 端侧人脸检测模型意义

在实际应用中，端侧的轻量级人脸检测模型具有至关重要的意义。端侧设备，如手机端、嵌入式设备和开发板设备，资源有限，包括计算能力、存储容量和功耗等方面。端侧的轻量级人脸检测模型能够在这些资源受限的设备上高效运行，实现实时的人脸检测功能。在手机端，轻量级人脸检测模型可以应用于自拍美颜、视频通话中的人脸跟踪自动对焦等功能。在嵌入式设备和开发板设备方面，如智能安防摄像头、智能门禁系统等，轻量级人脸检测模型可以在低功耗的情况下，快速准确地检测人脸，实现对人员的实时监控和身份识别，为保障公共安全和企业管理提供了有力支持。这充分体现了端侧轻量级人脸检测模型在现代智能设备中的不可或缺性。

本次课题主要包括两个方面，一是对人脸检测任务、轻量化CNN网络、端侧人脸检测模型的研究现状进行综述。二是对现有主流的轻量级人脸检测模型进行基准测试，通过设计一个通用的测试环境和评价标准，提供在各类场景下最佳的模型选择建议。

## 二、轻量化卷积网络

在端侧轻量级人脸检测模型，特别是单阶段检测架构中，backbone 的选择起着关键作用。它负责提取图像的特征，其性能和效果直接影响整个模型的效率和准确性。目前主流端侧模型都会优先考虑使用轻量化架构作为 backbone。接下来，我们就详细介绍三个经典的轻量化卷积网络：MobileNet、ShuffleNet 和 SqueezeNet。

特别说明的是，本次汇报介绍的三个网络都迭代了多个版本，以 mobilenet 为例，在 2017-2019 年之间发布过三个版本，今年四月又发布了 mobilenet v4。本次汇报仅对各个轻量化卷积网络模型的初始版本做一些简单介绍。

### 1. MobileNet

MobileNet由Google团队于2017年提出，它基于一种流线型架构，提出了深度可分离卷积（Depthwise Separable Convolution）来构建轻量级深层神经网络。

深度可分离卷积将传统卷积操作分解为深度卷积（Depthwise Conv）和逐点卷积（Pointwise Conv）两部分。以VGG为例，普通网络是直接进行Conv、BN、ReLU操作，而MobileNet基础模块先执行Depthwise Conv、BN、ReLU操作，再进行Pointwise Conv、BN、ReLU操作。

深度可分离卷积的优势明显，在相同权值参数数量下，相较于标准卷积，其计算量大幅减少。深度卷积中，一个卷积核仅处理一个通道，实现空间信息的提取；逐点卷积则负责将深度卷积得到的特征图进行通道信息融合，确保每个输出特征图包含所有输入特征图的信息。例如，对于一张$D_F×D_F×M$的方形特征图，标准卷积计算量为$D_K·D_K·M·N·D_F·D_F$，而深度可分离卷积计算量为$D_K·D_K·M·D_F·D_F+M·N·D_F·D_F$，两者计算量相除可得深度可分离卷积相对标准卷积减少的计算量比例。若引入超参数α（Width Multiplier）和ρ（Resolution Multiplier），计算量可进一步缩减。

然而，MobileNet也并非完美。ReLU激活函数在低维特征图上使用时，可能破坏特征，且当ReLU输出为0时会导致特征退化，虽可通过残差连接缓解，但仍是改进方向。

### 2. ShuffleNet

ShuffleNet由Face++团队（旷世科技）于2017年提出。与MobileNet等轻量化网络不同，ShuffleNet的独特之处在于采用通道重排（channel shuffle）等技术，提升计算资源利用率，优化信息流通。

ShuffleNet主要由ShuffleNet块（ShuffleNet Unit）逐层组合而成。每个ShuffleNet块包含分组卷积（Group Conv）、通道重排和逐点卷积三个关键步骤。分组卷积将卷积操作分组，减少参数量和计算量，但会引发信息流通不畅的问题；通道重排巧妙地重新排列特征通道，使不同通道间能够交互信息，解决分组卷积的弊端；逐点卷积则整合通道信息。

ShuffleNet的创新点在于结合group convolution和channel shuffle，其中channel shuffle原创性地解决了group convolution导致的信息孤岛问题。在网络拓扑结构上，ShuffleNet借鉴ResNet思想，与采用VGG思想的MobileNet形成差异。

不过，ShuffleNet也存在一些问题。Channel Shuffle操作较为耗时，影响实际运行速度，且其规则人为设定，具有一定人工设计特征的局限性。

### 3. SqueezeNet

SqueezeNet由伯克利和斯坦福的研究人员合作发表于2017年的ICLR会议。与传统卷积神经网络相比，它在参数量和计算量上显著降低，同时保持较高准确率，尤其适合资源受限设备部署。

SqueezeNet的设计关键有两点。一是广泛运用1×1卷积核，有效减少参数量和计算量；二是引入“squeeze - and - excitation”模块（Fire Module）提升网络表达能力。Fire Module由Squeeze和Extract两部分组成，Squeeze部分通过1×1卷积“压缩”特征图通道数，Extract部分则用1×1和3×3卷积提升通道数并拼接结果。使用Fire Module时，需确保Squeeze部分1×1卷积个数小于Extract部分卷积核个数之和，以控制3×3卷积输入通道数。SqueezeNet的网络结构类似VGG，通过堆叠Fire Module构建。

SqueezeNet采用三项策略压缩模型：以1×1卷积替代3×3卷积；减少3×3卷积输入通道数；延迟降采样操作，为卷积提供更大激活图，保留更多信息，提升分类准确率。但SqueezeNet也有缺点，其通过加深网络减少参数量，可能导致测试阶段耗时增加，在嵌入式场景应用时需谨慎考虑。
